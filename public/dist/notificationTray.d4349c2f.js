(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"4nQW":function(t,e,n){"use strict";n.r(e);var o=n("q1tI"),r=n.n(o),i=n("i8i4"),a=n("17x9"),s=n.n(a),c=n("IP2g"),u=n("twK/"),l=n("zHh7");function f(t){var e=t.messengerCount,n=t.translations,o=t.showMessenger,i=e,a=0===i?"grey":"tomato",s=0;switch(i.toString().length){case 2:s=1.45;break;case 3:s=1.2;break;case 4:s=.8;break;default:s=1.5}return r.a.createElement("span",{className:"fa-layers fa-fw",style:{marginRight:"0.3rem",minHeight:"120%"},title:Object(l.a)(n,"Message Wall"),onClick:function(){return o()}},r.a.createElement(c.a,{className:0===i?"text-muted":"alert-success",icon:u.a}),r.a.createElement("span",{className:"fa-layers-counter",style:{background:a,margin:"0.80rem "+s+"rem 0 0"}},i))}function h(t,e){if(null==t)return{};var n,o,r=function(t,e){if(null==t)return{};var n,o,r={},i=Object.keys(t);for(o=0;o<i.length;o++)n=i[o],e.indexOf(n)>=0||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)n=i[o],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function m(t){var e=t.notificationCount,n=t.translations,o=t.showNotifications,i=(h(t,["notificationCount","translations","showNotifications"]),e),a=0;switch(i.toString().length){case 2:a=1.25;break;case 3:a=1;break;case 4:a=.65;break;default:a=1.3}return r.a.createElement("span",{className:"fa-layers fa-fw",style:{marginRight:"0.3rem",minHeight:"120%"},title:Object(l.a)(n,"Notifications"),onClick:function(){return o()}},r.a.createElement(c.a,{className:0===i?"text-muted":"alert-success",icon:u.c}),r.a.createElement("span",{className:0===i?"fa-layers-counter text-counter-zero":"fa-layers-counter text-tomato",style:{margin:"0.80rem "+a+"rem 0 0"}},i))}f.defaultProps={messengerCount:0},m.defaultProps={notificationCount:0};var p=n("dWkn"),y=n("Hqpm");function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function g(){return(g=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t}).apply(this,arguments)}function b(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function w(t){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function v(t,e){return(v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function O(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var T=function(t){function e(t){var n,o,r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(n=!(r=w(e).call(this,t))||"object"!==d(r)&&"function"!=typeof r?O(o):r).displayTray=t.displayTray,n.locale=t.locale,n.isStaff=t.isStaff,n.otherProps=g({},t),n.state={likeCount:0,notificationCount:0,messengerCount:0},n.timeout=!0===n.isStaff?1e4:12e4,n.showNotifications=n.showNotifications.bind(O(O(n))),n.showMessenger=n.showMessenger.bind(O(O(n))),n}var n,i,a;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}(e,o["Component"]),n=e,(i=[{key:"componentDidMount",value:function(){this.displayTray&&(this.loadNotification(250+2e3*Math.random()),this.loadMessenger(250+2e3*Math.random()))}},{key:"componentWillUnmount",value:function(){clearTimeout(this.notificationTime),clearTimeout(this.messengerTime)}},{key:"loadNotification",value:function(t){var e=this;this.notificationTime=setTimeout(function(){Object(p.a)("/notification/details/",{method:"GET"},e.locale).then(function(t){t.count!==e.state.notiificationCount&&e.setState({notificationCount:t.count})}),e.loadNotification(e.timeout)},t)}},{key:"loadMessenger",value:function(t){var e=this;this.messengerTime=setTimeout(function(){Object(p.a)("/messenger/details/",{method:"GET"},e.locale).then(function(t){t.count!==e.state.messengerCount&&e.setState({messengerCount:t.count})}),e.loadMessenger(e.timeout)},t)}},{key:"showNotifications",value:function(){this.state.notificationCount>0&&Object(y.a)("/notification/show/",{method:"GET"},this.locale)}},{key:"showMessenger",value:function(){this.state.messengerCount>0&&Object(y.a)("/messenger/today/show/",{method:"GET"},this.locale)}},{key:"render",value:function(){return this.displayTray?r.a.createElement("div",{className:"text-right"},r.a.createElement(m,g({notificationCount:this.state.notificationCount},this.otherProps,{showNotifications:this.showNotifications})),r.a.createElement(f,g({messengerCount:this.state.messengerCount},this.otherProps,{showMessenger:this.showMessenger}))):r.a.createElement("div",null)}}])&&b(n.prototype,i),a&&b(n,a),e}();m.propTypes={displayTray:s.a.bool,isStaff:s.a.bool.isRequired,locale:s.a.string},m.defaultProps={displayTray:!1,locale:"en_GB"},Object(i.render)(r.a.createElement(T,window.TRAY_PROPS),document.getElementById("notificationTray"))},Hqpm:function(t,e,n){"use strict";function o(t,e,n){var o="_self";e&&"string"==typeof e.target&&(o=e.target);var r="";e&&"string"==typeof e.specs&&(r=e.specs),"boolean"==typeof n&&!1===n&&(n=""),null==n&&(n="en"),""!==n&&(n="/"+n),window.open(window.location.protocol+"//"+window.location.hostname+n+t,o,r)}n.d(e,"a",function(){return o})},dWkn:function(t,e,n){"use strict";function o(){return(o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t}).apply(this,arguments)}function r(t,e,n){var r={};e&&e.headers&&(r=e.headers,delete e.headers),r=o({},r,{"Content-Type":"application/json; charset=utf-8"}),null===n&&(n="en"),!1!==n&&""!==t||(n="");var a=window.location.protocol+"//"+window.location.hostname+"/";return fetch(a+n+t,o({},e,{credentials:"same-origin",headers:r})).then(i).then(function(t){return t.text().then(function(t){return t?JSON.parse(t):""})})}function i(t){if(t.status>=200&&t.status<400)return t;var e=new Error(t.statusText);throw e.response=t,e}n.d(e,"a",function(){return r})},zHh7:function(t,e,n){"use strict";function o(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e in t){var o=t[e];for(var r in n)o=o.replace(r,n[r]+"");return o}return e}n.d(e,"a",function(){return o})}},[["4nQW",0,1,2]]]);