(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"4nQW":function(t,e,n){"use strict";n.r(e);var o=n("q1tI"),a=n.n(o),r=n("i8i4"),i=n("17x9"),s=n.n(i),c=n("IP2g"),u=n("twK/"),l=n("zHh7");function f(t){var e=t.messengerCount,n=t.translations,o=t.showMessenger,r=e,i=0===r?"grey":"tomato",s=0;switch(r.toString().length){case 2:s=1.45;break;case 3:s=1.2;break;case 4:s=.8;break;default:s=1.5}return a.a.createElement("span",{className:"fa-layers fa-fw",style:{marginRight:"0.3rem",minHeight:"120%",float:"right",marginTop:"0"},title:Object(l.a)(n,"Message Wall"),onClick:function(){return o()}},a.a.createElement(c.a,{className:0===r?"text-muted":"alert-success",icon:u.a}),a.a.createElement("span",{className:"fa-layers-counter",style:{background:i,margin:"0.80rem "+s+"rem 0 0"}},r))}function h(t,e){if(null==t)return{};var n,o,a=function(t,e){if(null==t)return{};var n,o,a={},r=Object.keys(t);for(o=0;o<r.length;o++)n=r[o],e.indexOf(n)>=0||(a[n]=t[n]);return a}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(o=0;o<r.length;o++)n=r[o],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}function m(t){var e=t.notificationCount,n=t.translations,o=t.showNotifications,r=(h(t,["notificationCount","translations","showNotifications"]),e),i=0;switch(r.toString().length){case 2:i=1.25;break;case 3:i=1;break;case 4:i=.65;break;default:i=1.3}return a.a.createElement("span",{className:"fa-layers fa-fw",style:{marginRight:"0.3rem",minHeight:"120%",float:"right",marginTop:"-0.15rem"},title:Object(l.a)(n,"Notifications"),onClick:function(){return o()}},a.a.createElement(c.a,{className:0===r?"text-muted":"alert-success",icon:u.c}),a.a.createElement("span",{className:0===r?"fa-layers-counter text-counter-zero":"fa-layers-counter text-tomato",style:{margin:"0.97rem "+i+"rem 0 0"}},r))}f.defaultProps={messengerCount:0},m.defaultProps={notificationCount:0};var p=n("dWkn"),y=n("Hqpm"),g=n("wHSu");function d(t){var e=t.translations,n=t.handleLogout;return a.a.createElement("span",{className:"fa-fw",style:{minHeight:"120%",marginTop:"-0.45rem",float:"right"},title:Object(l.a)(e,"Logout"),onClick:function(){return n()}},a.a.createElement(c.a,{className:"alert-success",icon:g.c}))}function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function w(){return(w=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t}).apply(this,arguments)}function v(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function O(t){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function T(t,e){return(T=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function j(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var k=function(t){function e(t){var n,o,a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(n=!(a=O(e).call(this,t))||"object"!==b(a)&&"function"!=typeof a?j(o):a).displayTray=t.displayTray,n.locale=t.locale,n.isStaff=t.isStaff,n.otherProps=w({},t),n.state={likeCount:0,notificationCount:0,messengerCount:0},n.timeout=!0===n.isStaff?1e4:12e4,n.showNotifications=n.showNotifications.bind(j(j(n))),n.showMessenger=n.showMessenger.bind(j(j(n))),n.handleLogout=n.handleLogout.bind(j(j(n))),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&T(t,e)}(e,o["Component"]),n=e,(r=[{key:"componentDidMount",value:function(){this.displayTray&&(this.loadNotification(250+2e3*Math.random()),this.loadMessenger(250+2e3*Math.random()))}},{key:"componentWillUnmount",value:function(){clearTimeout(this.notificationTime),clearTimeout(this.messengerTime)}},{key:"loadNotification",value:function(t){var e=this;this.notificationTime=setTimeout(function(){Object(p.a)("/notification/details/",{method:"GET"},e.locale).then(function(t){t.count!==e.state.notiificationCount&&e.setState({notificationCount:t.count})}),e.loadNotification(e.timeout)},t)}},{key:"loadMessenger",value:function(t){var e=this;this.messengerTime=setTimeout(function(){Object(p.a)("/messenger/details/",{method:"GET"},e.locale).then(function(t){t.count!==e.state.messengerCount&&e.setState({messengerCount:t.count})}),e.loadMessenger(e.timeout)},t)}},{key:"showNotifications",value:function(){this.state.notificationCount>0&&Object(y.a)("/notification/show/",{method:"GET"},this.locale)}},{key:"showMessenger",value:function(){this.state.messengerCount>0&&Object(y.a)("/messenger/today/show/",{method:"GET"},this.locale)}},{key:"handleLogout",value:function(){Object(y.a)("/logout/",{method:"GET"},this.locale)}},{key:"render",value:function(){return this.displayTray?a.a.createElement("div",{className:"text-right"},a.a.createElement(d,w({handleLogout:this.handleLogout},this.otherProps)),a.a.createElement(f,w({messengerCount:this.state.messengerCount},this.otherProps,{showMessenger:this.showMessenger})),a.a.createElement(m,w({notificationCount:this.state.notificationCount},this.otherProps,{showNotifications:this.showNotifications}))):a.a.createElement("div",null)}}])&&v(n.prototype,r),i&&v(n,i),e}();m.propTypes={displayTray:s.a.bool,isStaff:s.a.bool.isRequired,locale:s.a.string},m.defaultProps={displayTray:!1,locale:"en_GB"},Object(r.render)(a.a.createElement(k,window.TRAY_PROPS),document.getElementById("notificationTray"))},Hqpm:function(t,e,n){"use strict";function o(t,e,n){var o="_self";e&&"string"==typeof e.target&&(o=e.target);var a="";e&&"string"==typeof e.specs&&(a=e.specs),"boolean"==typeof n&&!1===n&&(n=""),null==n&&(n="en"),""!==n&&(n="/"+n),window.open(window.location.protocol+"//"+window.location.hostname+n+t,o,a)}n.d(e,"a",function(){return o})},dWkn:function(t,e,n){"use strict";function o(){return(o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t}).apply(this,arguments)}function a(t,e,n){var a={};e&&e.headers&&(a=e.headers,delete e.headers),a=o({},a,{"Content-Type":"application/json; charset=utf-8"}),null===n&&(n="en"),!1!==n&&""!==t||(n="");var i=window.location.protocol+"//"+window.location.hostname+"/";return fetch(i+n+t,o({},e,{credentials:"same-origin",headers:a})).then(r).then(function(t){return t.text().then(function(t){return t?JSON.parse(t):""})})}function r(t){if(t.status>=200&&t.status<400)return t;var e=new Error(t.statusText);throw e.response=t,e}n.d(e,"a",function(){return a})},zHh7:function(t,e,n){"use strict";function o(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e in t){var o=t[e];for(var a in n)o=o.replace(a,n[a]+"");return o}return e}n.d(e,"a",function(){return o})}},[["4nQW",0,1,2]]]);