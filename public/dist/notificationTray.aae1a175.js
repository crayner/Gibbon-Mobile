(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"4nQW":function(t,e,n){"use strict";n.r(e);var o=n("q1tI"),r=n.n(o),a=n("i8i4"),i=(n("17x9"),n("IP2g")),s=n("twK/"),c=n("zHh7");function u(t){var e=t.messengerCount,n=t.translations,o=t.showMessenger,a=e,u=0===a?"grey":"tomato",l=0;switch(a.toString().length){case 2:l=1.45;break;case 3:l=1.2;break;case 4:l=.8;break;default:l=1.5}return r.a.createElement("span",{className:"fa-layers fa-fw",style:{marginRight:"0.3rem",minHeight:"120%",float:"right",marginTop:"0"},title:Object(c.a)(n,"Message Wall"),onClick:function(){return o()}},r.a.createElement(i.a,{className:0===a?"text-muted":"alert-success",icon:s.e}),r.a.createElement("span",{className:"fa-layers-counter",style:{background:u,margin:"0.80rem "+l+"rem 0 0"}},a))}function l(t,e){if(null==t)return{};var n,o,r=function(t,e){if(null==t)return{};var n,o,r={},a=Object.keys(t);for(o=0;o<a.length;o++)n=a[o],e.indexOf(n)>=0||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(o=0;o<a.length;o++)n=a[o],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function f(t){var e=t.notificationCount,n=t.translations,o=t.showNotifications,a=(l(t,["notificationCount","translations","showNotifications"]),e),u=0;switch(a.toString().length){case 2:u=1.25;break;case 3:u=1;break;case 4:u=.65;break;default:u=1.3}return r.a.createElement("span",{className:"fa-layers fa-fw",style:{marginRight:"0.3rem",minHeight:"120%",float:"right",marginTop:"-0.15rem"},title:Object(c.a)(n,"Notifications"),onClick:function(){return o()}},r.a.createElement(i.a,{className:0===a?"text-muted":"alert-success",icon:s.g}),r.a.createElement("span",{className:0===a?"fa-layers-counter text-counter-zero":"fa-layers-counter text-tomato",style:{margin:"0.97rem "+u+"rem 0 0"}},a))}u.defaultProps={messengerCount:0},f.defaultProps={notificationCount:0};var h=n("dWkn"),m=n("Hqpm"),p=n("wHSu");function y(t){var e=t.translations,n=t.handleLogout;return r.a.createElement("span",{className:"fa-fw",style:{minHeight:"120%",marginTop:"-0.45rem",float:"right"},title:Object(c.a)(e,"Logout"),onClick:function(){return n()}},r.a.createElement(i.a,{className:"alert-success",icon:p.c}))}function g(t){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function d(){return(d=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t}).apply(this,arguments)}function b(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function w(t){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function v(t,e){return(v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function O(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var T=function(t){function e(t){var n,o,r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(n=!(r=w(e).call(this,t))||"object"!==g(r)&&"function"!=typeof r?O(o):r).displayTray=t.displayTray,n.locale=t.locale,n.isStaff=t.isStaff,n.otherProps=d({},t),n.state={likeCount:0,notificationCount:0,messengerCount:0},n.timeout=!0===n.isStaff?1e4:12e4,n.showNotifications=n.showNotifications.bind(O(O(n))),n.showMessenger=n.showMessenger.bind(O(O(n))),n.handleLogout=n.handleLogout.bind(O(O(n))),n}var n,a,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}(e,o["Component"]),n=e,(a=[{key:"componentDidMount",value:function(){this.displayTray&&(this.loadNotification(250+2e3*Math.random()),this.loadMessenger(250+2e3*Math.random()))}},{key:"componentWillUnmount",value:function(){clearTimeout(this.notificationTime),clearTimeout(this.messengerTime)}},{key:"loadNotification",value:function(t){var e=this;this.notificationTime=setTimeout(function(){Object(h.a)("/notification/details/",{method:"GET"},e.locale).then(function(t){t.count!==e.state.notiificationCount&&e.setState({notificationCount:t.count})}),e.loadNotification(e.timeout)},t)}},{key:"loadMessenger",value:function(t){var e=this;this.messengerTime=setTimeout(function(){Object(h.a)("/messenger/details/",{method:"GET"},e.locale).then(function(t){t.count!==e.state.messengerCount&&e.setState({messengerCount:t.count})}),e.loadMessenger(e.timeout)},t)}},{key:"showNotifications",value:function(){this.state.notificationCount>0&&Object(m.a)("/notification/show/",{method:"GET"},this.locale)}},{key:"showMessenger",value:function(){this.state.messengerCount>0&&Object(m.a)("/messenger/today/show/",{method:"GET"},this.locale)}},{key:"handleLogout",value:function(){Object(m.a)("/logout/",{method:"GET"},!1)}},{key:"render",value:function(){return this.displayTray?r.a.createElement("div",{className:"text-right"},r.a.createElement(y,d({handleLogout:this.handleLogout},this.otherProps)),r.a.createElement(u,d({messengerCount:this.state.messengerCount},this.otherProps,{showMessenger:this.showMessenger})),r.a.createElement(f,d({notificationCount:this.state.notificationCount},this.otherProps,{showNotifications:this.showNotifications}))):r.a.createElement("div",null)}}])&&b(n.prototype,a),i&&b(n,i),e}();T.defaultProps={displayTray:!1,locale:"en_GB"},Object(a.render)(r.a.createElement(T,window.TRAY_PROPS),document.getElementById("notificationTray"))},Hqpm:function(t,e,n){"use strict";function o(t,e,n){var o="_self";e&&"string"==typeof e.target&&(o=e.target);var r="";e&&"string"==typeof e.specs&&(r=e.specs),"boolean"==typeof n&&!1===n&&(n=""),null==n&&(n="en"),""!==n&&(n="/"+n),window.open(window.location.protocol+"//"+window.location.hostname+n+t,o,r)}n.d(e,"a",function(){return o})},dWkn:function(t,e,n){"use strict";function o(){return(o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t}).apply(this,arguments)}function r(t,e,n){var r={};e&&e.headers&&(r=e.headers,delete e.headers),r=o({},r,{"Content-Type":"application/json; charset=utf-8"}),null===n&&(n="en"),!1!==n&&""!==t||(n="");var i=window.location.protocol+"//"+window.location.hostname+"/";return fetch(i+n+t,o({},e,{credentials:"same-origin",headers:r})).then(a).then(function(t){return t.text().then(function(t){return t?JSON.parse(t):""})})}function a(t){if(t.status>=200&&t.status<400)return t;var e=new Error(t.statusText);throw e.response=t,e}n.d(e,"a",function(){return r})},zHh7:function(t,e,n){"use strict";function o(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e in t){var o=t[e];for(var r in n)o=o.replace(r,n[r]+"");return o}return e}n.d(e,"a",function(){return o})}},[["4nQW",0,1,2]]]);